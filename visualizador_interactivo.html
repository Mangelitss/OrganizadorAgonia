
    <!DOCTYPE html>
    <html lang="es">
    <head>
        <meta charset="UTF-8">
        <title>Gestor Inteligente Agon√≠a</title>
        <style>
            body { font-family: 'Segoe UI', sans-serif; background: #0a0a0a; color: white; padding: 20px; }
            .controles { position: sticky; top: 0; background: #1a1a1a; padding: 15px; z-index: 100; border-bottom: 2px solid #333; display: flex; justify-content: space-between; }
            .turno-container { background: #151515; padding: 20px; margin-bottom: 40px; border-radius: 15px; border: 1px solid #333; }
            .grid-trono { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; }
            .vara { background: #1e1e1e; padding: 15px; border-radius: 10px; border-top: 5px solid #d35400; }
            .seccion { background: #252525; padding: 10px; margin: 10px 0; border-radius: 5px; min-height: 150px; border: 1px dashed #444; }
            .costalero { background: #333; margin: 5px 0; padding: 8px; border-radius: 4px; cursor: move; display: flex; justify-content: space-between; align-items: center; font-size: 11px; }
            .costalero.vacio { border: 1px dashed #555; background: #111; color: #555; cursor: default; flex-direction: column; align-items: stretch; }
            .costalero.sobrepeso { border: 2px solid #ff4757; background: #4a1515; }
            .costalero.bloqueado { border-left: 5px solid #f1c40f; background: #2c2c00; }
            .stats-box { background: #000; padding: 8px; border-radius: 4px; font-size: 10px; color: #03dac6; margin-top: 5px; border-left: 3px solid #03dac6; }
            input.search-p { background: #000; border: 1px solid #444; color: #03dac6; padding: 5px; width: 100%; font-size: 10px; border-radius: 3px; outline: none; }
            .sugerencias { background: #000; border: 1px solid #333; max-height: 80px; overflow-y: auto; position: absolute; z-index: 200; width: 200px; }
            .sug-item { padding: 5px; cursor: pointer; border-bottom: 1px solid #222; }
            .sug-item:hover { background: #222; }
        </style>
    </head>
    <body>
        <div class="controles">
            <div style="font-size:16px; font-weight:bold; color:#d35400">LA AGON√çA - GESTI√ìN TIEMPO REAL</div>
            <div style="font-size:11px; color:#aaa">F√≠sica autom√°tica | Autocompletar en huecos libres | Intercambio por arrastre</div>
        </div>
        <div id="app"></div>

        <script>
            let datos = {"Turno A": {"Izquierda": {"Delante": [{"id": 19, "nombre": "Jose Antonio Lid\u00f3n P\u00e9rez", "altura": 155, "pref_hombro": "", "puede_repetir": false, "bloqueado": false}, {"id": 1, "nombre": "Aitor Guirao Rodriguez", "altura": 151, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 21, "nombre": "Antonio Jes\u00fas Cabrera Ferr\u00e1nd", "altura": 150, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 16, "nombre": "Ram\u00f3n Escobedo P\u00e9rez", "altura": 149, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 23, "nombre": "Ra\u00fal Donate Escudero", "altura": 148, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 5, "nombre": "Natalia Belmonte Bas", "altura": 146, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}], "Detras": [{"id": 7, "nombre": "Pablo Mart\u00ednez P\u00e9rez", "altura": 139, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 8, "nombre": "M Rosa Garc\u00eda Cabrera", "altura": 140, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 31, "nombre": "Antonio Lid\u00f3n Mart\u00ednez", "altura": 140, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 32, "nombre": "Ana Isabel Mart\u00ednez Javaloyes", "altura": 143, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 28, "nombre": "Mariano Diaz V\u00e9lez", "altura": 144, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 11, "nombre": "\u00c1lvaro Sarmiento Caselles", "altura": 145, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}]}, "Centro": {"Delante": [{"id": 13, "nombre": "David Lorca Rodr\u00edguez", "altura": 154, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 20, "nombre": "Nuria Ortega Lid\u00f3n", "altura": 151, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 2, "nombre": "Cristo Fernando Abad\u00eda L\u00f3p", "altura": 149, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 17, "nombre": "Abraham Sarmiento Mar\u00edn", "altura": 149, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 4, "nombre": "Beatriz Jara Rodriguez", "altura": 147, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 6, "nombre": "Milagros Pe\u00f1alver Lorenzo", "altura": 146, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}], "Detras": [{"id": 24, "nombre": "Cristina Rubio Blanco", "altura": 139, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 25, "nombre": "Ana M Rodr\u00edguez Lorente", "altura": 140, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 26, "nombre": "Pilar de Lourdes Mart\u00ednez P", "altura": 142, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 9, "nombre": "M Dolores Rodriguez Lorente", "altura": 144, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 33, "nombre": "Monserrate Coll Mula", "altura": 144, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 29, "nombre": "Cristina S\u00e1nchez Moya", "altura": 145, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}]}, "Derecha": {"Delante": [{"id": 14, "nombre": "Iv\u00e1n Fenoll Rodriguez", "altura": 152, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 15, "nombre": "Oscar Martinez Mora", "altura": 150, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 3, "nombre": "Miguel \u00c1ngel Amor\u00f3s Rodr\u00edg", "altura": 149, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 22, "nombre": "Miguel Angel Espinosa Mula", "altura": 149, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 18, "nombre": "Daniel Mira Juan", "altura": 147, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 12, "nombre": "Moises Lorente Irles", "altura": 146, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}], "Detras": [{"id": 36, "nombre": "Jose Ram\u00f3n Escobedo Med", "altura": 139, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 30, "nombre": "Zenaida Carmen Vivancos Vivar", "altura": 140, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 27, "nombre": "Carmen M Hern\u00e1ndez C\u00e1ma", "altura": 143, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 10, "nombre": "Cinthia Bernab\u00e9 Donate", "altura": 144, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 34, "nombre": "M Jes\u00fas Tovar Cuenca", "altura": 144, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 35, "nombre": "Gelen Huertas Mateo", "altura": 146, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}]}}, "Turno B": {"Izquierda": {"Delante": [{"id": 14, "nombre": "Iv\u00e1n Fenoll Rodriguez (R)", "altura": 152, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 49, "nombre": "Iluminada M Cabrera Ferr\u00e1nd", "altura": 138, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 38, "nombre": "Alicia Murcia Ros", "altura": 137, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 40, "nombre": "Blanca Rosa Medina Oltra", "altura": 136, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 52, "nombre": "Lydia Espinosa Fenoll", "altura": 136, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 63, "nombre": "Sandra Merino Hern\u00e1ndez", "altura": 136, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}], "Detras": [{"id": 42, "nombre": "M Jos\u00e9 S\u00e1nchez Fern\u00e1ndez", "altura": 128, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 66, "nombre": "Claudia Ruiz Caselles", "altura": 129, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 44, "nombre": "Nuria Lagu\u00eda Mart\u00ednez", "altura": 131, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 46, "nombre": "M Pilar Cerezo Palop", "altura": 133, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 69, "nombre": "Raquel Rodr\u00edguez Escudero", "altura": 133, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 70, "nombre": "Abigail Garc\u00eda Botella", "altura": 134, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}]}, "Centro": {"Delante": [{"id": 48, "nombre": "M\u00f3nica Corbal\u00e1n Navarro", "altura": 139, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 50, "nombre": "Leticia Padilla Cuerdo", "altura": 138, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 61, "nombre": "\u00c1ngela Cerezo L\u00f3pez", "altura": 137, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 41, "nombre": "Paula Marco Ru\u00edz", "altura": 136, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 53, "nombre": "Mar\u00eda Lorente Z\u00e1rate", "altura": 136, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 64, "nombre": "Sofia Bas Mart\u00ed", "altura": 136, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}], "Detras": [{"id": 54, "nombre": "Sof\u00eda Vinuesa Mart\u00ednez", "altura": 128, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 55, "nombre": "Noem\u00ed Garc\u00eda Bernab\u00e9", "altura": 130, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 45, "nombre": "Carmen Bas Mart\u00ed", "altura": 132, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 57, "nombre": "Esther Cano Berm\u00fadez", "altura": 133, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 47, "nombre": "M Dolores Z\u00e1rate Chumillas", "altura": 134, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 71, "nombre": "Lola Bas Mart\u00ed", "altura": 134, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}]}, "Derecha": {"Delante": [{"id": 37, "nombre": "Carla Fern\u00e1ndez Ballesta", "altura": 138, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 60, "nombre": "Rosario Fructuoso Huertas", "altura": 138, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 39, "nombre": "M Adela Ros Mar\u00edn", "altura": 136, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 51, "nombre": "Lourdes Egio Pardines", "altura": 136, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 62, "nombre": "Alba Sempere Mart\u00ednez", "altura": 136, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 59, "nombre": "Paula Martinez Casanova", "altura": 135, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}], "Detras": [{"id": 43, "nombre": "Erika Navarro Zaragoza", "altura": 129, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 67, "nombre": "Inmaculada And\u00fagar Costa", "altura": 130, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 56, "nombre": "Visi D\u00edaz Hern\u00e1ndez", "altura": 132, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 68, "nombre": "M del Mar Garc\u00eda Grau", "altura": 133, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 58, "nombre": "Pilar Ru\u00edz Cerezo", "altura": 134, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}, {"id": 65, "nombre": "Anabel Arce Pedrique", "altura": 135, "pref_hombro": "", "puede_repetir": true, "bloqueado": false}]}}};
            const MASTER_LIST = [{"id": 1, "nombre": "Aitor Guirao Rodriguez", "altura": 151, "pref_hombro": "", "puede_repetir": true}, {"id": 2, "nombre": "Cristo Fernando Abad\u00eda L\u00f3p", "altura": 149, "pref_hombro": "", "puede_repetir": true}, {"id": 3, "nombre": "Miguel \u00c1ngel Amor\u00f3s Rodr\u00edg", "altura": 149, "pref_hombro": "", "puede_repetir": true}, {"id": 4, "nombre": "Beatriz Jara Rodriguez", "altura": 147, "pref_hombro": "", "puede_repetir": true}, {"id": 5, "nombre": "Natalia Belmonte Bas", "altura": 146, "pref_hombro": "", "puede_repetir": true}, {"id": 6, "nombre": "Milagros Pe\u00f1alver Lorenzo", "altura": 146, "pref_hombro": "", "puede_repetir": true}, {"id": 7, "nombre": "Pablo Mart\u00ednez P\u00e9rez", "altura": 139, "pref_hombro": "", "puede_repetir": true}, {"id": 8, "nombre": "M Rosa Garc\u00eda Cabrera", "altura": 140, "pref_hombro": "", "puede_repetir": true}, {"id": 9, "nombre": "M Dolores Rodriguez Lorente", "altura": 144, "pref_hombro": "", "puede_repetir": true}, {"id": 10, "nombre": "Cinthia Bernab\u00e9 Donate", "altura": 144, "pref_hombro": "", "puede_repetir": true}, {"id": 11, "nombre": "\u00c1lvaro Sarmiento Caselles", "altura": 145, "pref_hombro": "", "puede_repetir": true}, {"id": 12, "nombre": "Moises Lorente Irles", "altura": 146, "pref_hombro": "", "puede_repetir": true}, {"id": 13, "nombre": "David Lorca Rodr\u00edguez", "altura": 154, "pref_hombro": "", "puede_repetir": true}, {"id": 14, "nombre": "Iv\u00e1n Fenoll Rodriguez", "altura": 152, "pref_hombro": "", "puede_repetir": true}, {"id": 15, "nombre": "Oscar Martinez Mora", "altura": 150, "pref_hombro": "", "puede_repetir": true}, {"id": 16, "nombre": "Ram\u00f3n Escobedo P\u00e9rez", "altura": 149, "pref_hombro": "", "puede_repetir": true}, {"id": 17, "nombre": "Abraham Sarmiento Mar\u00edn", "altura": 149, "pref_hombro": "", "puede_repetir": true}, {"id": 18, "nombre": "Daniel Mira Juan", "altura": 147, "pref_hombro": "", "puede_repetir": true}, {"id": 19, "nombre": "Jose Antonio Lid\u00f3n P\u00e9rez", "altura": 155, "pref_hombro": "", "puede_repetir": false}, {"id": 20, "nombre": "Nuria Ortega Lid\u00f3n", "altura": 151, "pref_hombro": "", "puede_repetir": true}, {"id": 21, "nombre": "Antonio Jes\u00fas Cabrera Ferr\u00e1nd", "altura": 150, "pref_hombro": "", "puede_repetir": true}, {"id": 22, "nombre": "Miguel Angel Espinosa Mula", "altura": 149, "pref_hombro": "", "puede_repetir": true}, {"id": 23, "nombre": "Ra\u00fal Donate Escudero", "altura": 148, "pref_hombro": "", "puede_repetir": true}, {"id": 24, "nombre": "Cristina Rubio Blanco", "altura": 139, "pref_hombro": "", "puede_repetir": true}, {"id": 25, "nombre": "Ana M Rodr\u00edguez Lorente", "altura": 140, "pref_hombro": "", "puede_repetir": true}, {"id": 26, "nombre": "Pilar de Lourdes Mart\u00ednez P", "altura": 142, "pref_hombro": "", "puede_repetir": true}, {"id": 27, "nombre": "Carmen M Hern\u00e1ndez C\u00e1ma", "altura": 143, "pref_hombro": "", "puede_repetir": true}, {"id": 28, "nombre": "Mariano Diaz V\u00e9lez", "altura": 144, "pref_hombro": "", "puede_repetir": true}, {"id": 29, "nombre": "Cristina S\u00e1nchez Moya", "altura": 145, "pref_hombro": "", "puede_repetir": true}, {"id": 30, "nombre": "Zenaida Carmen Vivancos Vivar", "altura": 140, "pref_hombro": "", "puede_repetir": true}, {"id": 31, "nombre": "Antonio Lid\u00f3n Mart\u00ednez", "altura": 140, "pref_hombro": "", "puede_repetir": true}, {"id": 32, "nombre": "Ana Isabel Mart\u00ednez Javaloyes", "altura": 143, "pref_hombro": "", "puede_repetir": true}, {"id": 33, "nombre": "Monserrate Coll Mula", "altura": 144, "pref_hombro": "", "puede_repetir": true}, {"id": 34, "nombre": "M Jes\u00fas Tovar Cuenca", "altura": 144, "pref_hombro": "", "puede_repetir": true}, {"id": 35, "nombre": "Gelen Huertas Mateo", "altura": 146, "pref_hombro": "", "puede_repetir": true}, {"id": 36, "nombre": "Jose Ram\u00f3n Escobedo Med", "altura": 139, "pref_hombro": "", "puede_repetir": true}, {"id": 37, "nombre": "Carla Fern\u00e1ndez Ballesta", "altura": 138, "pref_hombro": "", "puede_repetir": true}, {"id": 38, "nombre": "Alicia Murcia Ros", "altura": 137, "pref_hombro": "", "puede_repetir": true}, {"id": 39, "nombre": "M Adela Ros Mar\u00edn", "altura": 136, "pref_hombro": "", "puede_repetir": true}, {"id": 40, "nombre": "Blanca Rosa Medina Oltra", "altura": 136, "pref_hombro": "", "puede_repetir": true}, {"id": 41, "nombre": "Paula Marco Ru\u00edz", "altura": 136, "pref_hombro": "", "puede_repetir": true}, {"id": 42, "nombre": "M Jos\u00e9 S\u00e1nchez Fern\u00e1ndez", "altura": 128, "pref_hombro": "", "puede_repetir": true}, {"id": 43, "nombre": "Erika Navarro Zaragoza", "altura": 129, "pref_hombro": "", "puede_repetir": true}, {"id": 44, "nombre": "Nuria Lagu\u00eda Mart\u00ednez", "altura": 131, "pref_hombro": "", "puede_repetir": true}, {"id": 45, "nombre": "Carmen Bas Mart\u00ed", "altura": 132, "pref_hombro": "", "puede_repetir": true}, {"id": 46, "nombre": "M Pilar Cerezo Palop", "altura": 133, "pref_hombro": "", "puede_repetir": true}, {"id": 47, "nombre": "M Dolores Z\u00e1rate Chumillas", "altura": 134, "pref_hombro": "", "puede_repetir": true}, {"id": 48, "nombre": "M\u00f3nica Corbal\u00e1n Navarro", "altura": 139, "pref_hombro": "", "puede_repetir": true}, {"id": 49, "nombre": "Iluminada M Cabrera Ferr\u00e1nd", "altura": 138, "pref_hombro": "", "puede_repetir": true}, {"id": 50, "nombre": "Leticia Padilla Cuerdo", "altura": 138, "pref_hombro": "", "puede_repetir": true}, {"id": 51, "nombre": "Lourdes Egio Pardines", "altura": 136, "pref_hombro": "", "puede_repetir": true}, {"id": 52, "nombre": "Lydia Espinosa Fenoll", "altura": 136, "pref_hombro": "", "puede_repetir": true}, {"id": 53, "nombre": "Mar\u00eda Lorente Z\u00e1rate", "altura": 136, "pref_hombro": "", "puede_repetir": true}, {"id": 54, "nombre": "Sof\u00eda Vinuesa Mart\u00ednez", "altura": 128, "pref_hombro": "", "puede_repetir": true}, {"id": 55, "nombre": "Noem\u00ed Garc\u00eda Bernab\u00e9", "altura": 130, "pref_hombro": "", "puede_repetir": true}, {"id": 56, "nombre": "Visi D\u00edaz Hern\u00e1ndez", "altura": 132, "pref_hombro": "", "puede_repetir": true}, {"id": 57, "nombre": "Esther Cano Berm\u00fadez", "altura": 133, "pref_hombro": "", "puede_repetir": true}, {"id": 58, "nombre": "Pilar Ru\u00edz Cerezo", "altura": 134, "pref_hombro": "", "puede_repetir": true}, {"id": 59, "nombre": "Paula Martinez Casanova", "altura": 135, "pref_hombro": "", "puede_repetir": true}, {"id": 60, "nombre": "Rosario Fructuoso Huertas", "altura": 138, "pref_hombro": "", "puede_repetir": true}, {"id": 61, "nombre": "\u00c1ngela Cerezo L\u00f3pez", "altura": 137, "pref_hombro": "", "puede_repetir": true}, {"id": 62, "nombre": "Alba Sempere Mart\u00ednez", "altura": 136, "pref_hombro": "", "puede_repetir": true}, {"id": 63, "nombre": "Sandra Merino Hern\u00e1ndez", "altura": 136, "pref_hombro": "", "puede_repetir": true}, {"id": 64, "nombre": "Sofia Bas Mart\u00ed", "altura": 136, "pref_hombro": "", "puede_repetir": true}, {"id": 65, "nombre": "Anabel Arce Pedrique", "altura": 135, "pref_hombro": "", "puede_repetir": true}, {"id": 66, "nombre": "Claudia Ruiz Caselles", "altura": 129, "pref_hombro": "", "puede_repetir": true}, {"id": 67, "nombre": "Inmaculada And\u00fagar Costa", "altura": 130, "pref_hombro": "", "puede_repetir": true}, {"id": 68, "nombre": "M del Mar Garc\u00eda Grau", "altura": 133, "pref_hombro": "", "puede_repetir": true}, {"id": 69, "nombre": "Raquel Rodr\u00edguez Escudero", "altura": 133, "pref_hombro": "", "puede_repetir": true}, {"id": 70, "nombre": "Abigail Garc\u00eda Botella", "altura": 134, "pref_hombro": "", "puede_repetir": true}, {"id": 71, "nombre": "Lola Bas Mart\u00ed", "altura": 134, "pref_hombro": "", "puede_repetir": true}];
            const PESO_TOTAL = 2000;
            const MAX_KG = 90;

            function render() {
                const app = document.getElementById('app');
                app.innerHTML = '';
                for (const [idT, varas] of Object.entries(datos)) {
                    let html = `<div class="turno-container"><h2>${idT}</h2><div class="grid-trono">`;
                    for (const vNom of ["Izquierda", "Centro", "Derecha"]) {
                        let vData = varas[vNom];
                        const statsVara = calcularStats(vData.Delante.concat(vData.Detras));
                        html += `<div class="vara"><h3>VARA ${vNom.toUpperCase()}</h3>`;
                        ["Delante", "Detras"].forEach(sec => {
                            const statsSec = calcularStats(vData[sec]);
                            html += `<div class="stats-box"><b>${sec.toUpperCase()}:</b> ${statsSec.media.toFixed(1)}cm | ${statsSec.totalVara.toFixed(1)}kg</div>`;
                            html += `<div class="seccion" ondragover="allow(event)">`;
                            vData[sec].forEach((p, i) => {
                                const esVacio = p.altura === 0;
                                const esSobrepeso = p.peso >= MAX_KG;
                                html += `
                                    <div class="costalero ${esVacio ? 'vacio' : ''} ${p.bloqueado ? 'bloqueado' : ''} ${esSobrepeso ? 'sobrepeso' : ''}" 
                                         draggable="${!esVacio}" ondragstart="drag(event, '${idT}', '${vNom}', '${sec}', ${i})" ondrop="drop(event, '${idT}', '${vNom}', '${sec}', ${i})">
                                        ${esVacio ? 
                                            `<input type="text" class="search-p" placeholder="Escribir nombre..." onkeyup="buscar(event, '${idT}','${vNom}','${sec}',${i})">
                                             <div id="sug-${idT}-${vNom}-${sec}-${i}" class="sugerencias" style="display:none"></div>` :
                                            `<span>
                                                <button style="background:none; border:none; color:#ff4757; cursor:pointer" onclick="eliminar('${idT}','${vNom}','${sec}',${i})">üóëÔ∏è</button>
                                                <button style="background:none; border:none; color:white; cursor:pointer" onclick="toggle('${idT}','${vNom}','${sec}',${i})">${p.bloqueado ? 'üîí' : 'üîì'}</button>
                                                ${p.nombre}
                                            </span>
                                            <span><span style="color:#f1c40f">${p.altura}cm</span> <b style="color:#03dac6; margin-left:5px">${p.peso.toFixed(1)}kg</b></span>`
                                        }
                                    </div>`;
                            });
                            html += `</div>`;
                        });
                        html += `<div style="text-align:center; padding:10px; border:1px solid #03dac6; border-radius:5px; font-size:12px"><b>TOTAL VARA: ${statsVara.totalVara.toFixed(1)} kg</b></div></div>`;
                    }
                    app.innerHTML += html + `</div></div>`;
                }
            }

            function calcularStats(p_list) {
                let filtrados = p_list.filter(p => p.altura > 0);
                let m = filtrados.length > 0 ? filtrados.reduce((a, b) => a + b.altura, 0) / filtrados.length : 0;
                let tV = 0; const base = PESO_TOTAL / 36;
                p_list.forEach(p => {
                    if(p.altura > 0) {
                        p.peso = Math.min(MAX_KG, Math.max(0, base + ((p.altura - m) * (base * 0.05))));
                        tV += p.peso;
                    } else p.peso = 0;
                });
                return { media: m, totalVara: tV };
            }

            function buscar(ev, t, v, s, i) {
                const val = ev.target.value.toLowerCase();
                const sugDiv = document.getElementById(`sug-${t}-${v}-${s}-${i}`);
                if(val.length < 2) { sugDiv.style.display = 'none'; return; }
                const matches = MASTER_LIST.filter(p => p.nombre.toLowerCase().includes(val)).slice(0, 5);
                sugDiv.innerHTML = '';
                if(matches.length > 0) {
                    sugDiv.style.display = 'block';
                    matches.forEach(m => {
                        const div = document.createElement('div');
                        div.className = 'sug-item';
                        div.innerHTML = `${m.nombre} (${m.altura}cm)`;
                        div.onclick = () => { datos[t][v][s][i] = {...m, bloqueado: false}; render(); };
                        sugDiv.appendChild(div);
                    });
                } else sugDiv.style.display = 'none';
            }

            let dragging = null;
            function allow(ev) { ev.preventDefault(); }
            function drag(ev, t, v, s, i) { dragging = { t, v, s, i }; }
            function drop(ev, t, v, s, i) {
                ev.preventDefault();
                let orig = datos[dragging.t][dragging.v][dragging.s][dragging.i];
                datos[dragging.t][dragging.v][dragging.s][dragging.i] = datos[t][v][s][i];
                datos[t][v][s][i] = orig;
                render();
            }
            function eliminar(t, v, s, i) { datos[t][v][s][i] = {"nombre": "HUECO LIBRE", "altura": 0, "bloqueado": false}; render(); }
            function toggle(t, v, s, i) { datos[t][v][s][i].bloqueado = !datos[t][v][s][i].bloqueado; render(); }
            window.onload = render;
        </script>
    </body>
    </html>
    